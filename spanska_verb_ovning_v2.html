<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spanska Verb √ñvning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #2E75B6;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 30px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .reset-btn {
            background: #e74c3c;
            color: white;
        }
        
        .reset-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        
        .check-all-btn {
            background: #2ecc71;
            color: white;
        }
        
        .check-all-btn:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }
        
        .verb-section {
            margin-bottom: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            background: #f9f9f9;
        }
        
        .verb-category {
            font-size: 1.8em;
            color: #2E75B6;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .verb-header {
            font-size: 1.3em;
            color: #555;
            margin-bottom: 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .verb-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .verb-table th {
            background: #4472C4;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        .verb-table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .verb-table tr:last-child td {
            border-bottom: none;
        }
        
        .verb-table tr:hover {
            background: #f5f5f5;
        }
        
        .spanish-text {
            font-weight: bold;
            color: #2E75B6;
        }
        
        .input-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        input[type="text"] {
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            flex: 1;
            transition: all 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #4472C4;
        }
        
        input[type="text"].correct {
            border-color: #2ecc71;
            background: #e8f8f5;
        }
        
        input[type="text"].incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
        }
        

        .feedback {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
        }
        
        .correct-icon {
            color: #2ecc71;
            font-size: 24px;
            font-weight: bold;
        }
        
        .speaker-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 20px;
            padding: 4px 8px;
            color: #666;
            transition: all 0.2s;
        }
        
        .speaker-btn:hover {
            color: #2E75B6;
            transform: scale(1.1);
        }
        
        .speaker-btn:active {
            transform: scale(0.95);
        }
        
        .check-btn {
            padding: 8px 16px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .check-btn:hover {
            background: #2980b9;
        }
        
        .check-btn:active {
            transform: scale(0.95);
        }
        
        .incorrect-text {
            color: #e74c3c;
            font-size: 14px;
        }
        
        .correct-answer {
            color: #2ecc71;
            font-weight: bold;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .subtitle {
                font-size: 1em;
            }
            
            .verb-table {
                font-size: 14px;
            }
            
            .verb-table th, .verb-table td {
                padding: 10px 8px;
            }
            
            input[type="text"] {
                font-size: 16px;
                padding: 12px;
            }
            
            .feedback {
                font-size: 13px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .controls button {
                width: 100%;
                font-size: 16px;
                padding: 14px;
            }
            
            .verb-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                font-size: 1.1em;
            }
            
            .verb-header > div {
                width: 100%;
            }
        }
        
        .progress {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #e8f4f8;
            border-radius: 8px;
            font-size: 1.1em;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71 0%, #27ae60 100%);
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üá™üá∏ Spanska Verb √ñvning üá∏üá™</h1>
        <p class="subtitle">√ñva spanska verbb√∂jningar och √∂vers√§ttningar</p>
        
        <div class="progress">
            <div>Framsteg: <span id="correct-count">0</span> av <span id="total-count">0</span> korrekta</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%">0%</div>
            </div>
        </div>
        
        <div class="controls">
            <button class="reset-btn" onclick="resetAll()">üîÑ Rensa allt</button>
            <button class="check-all-btn" onclick="checkAll()">‚úì Kontrollera alla</button>
            <button class="check-all-btn" onclick="fillAll()" style="background: #9b59b6;">üìù Fyll i alla svar</button>
        </div>
        
        <div id="verbs-container"></div>
    </div>

    <script>
        const verbData = {
            "I. -AR-verb": {
                "HABLAR (prata)": [
                    { person: "yo", spanish: "hablo", swedish: "jag" },
                    { person: "t√∫", spanish: "hablas", swedish: "du" },
                    { person: "√©l/ella/usted", spanish: "habla", swedish: "han/hon/ni" },
                    { person: "nosotros/nosotras", spanish: "hablamos", swedish: "vi" },
                    { person: "vosotros/vosotras", spanish: "habl√°is", swedish: "ni" },
                    { person: "ellos/ellas/ustedes", spanish: "hablan", swedish: "de/ni" }
                ],
                "ESTUDIAR (studera)": [
                    { person: "yo", spanish: "estudio" },
                    { person: "t√∫", spanish: "estudias" },
                    { person: "√©l/ella/usted", spanish: "estudia" },
                    { person: "nosotros/nosotras", spanish: "estudiamos" },
                    { person: "vosotros/vosotras", spanish: "estudi√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "estudian" }
                ],
                "TRABAJAR (arbeta)": [
                    { person: "yo", spanish: "trabajo" },
                    { person: "t√∫", spanish: "trabajas" },
                    { person: "√©l/ella/usted", spanish: "trabaja" },
                    { person: "nosotros/nosotras", spanish: "trabajamos" },
                    { person: "vosotros/vosotras", spanish: "trabaj√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "trabajan" }
                ],
                "CANTAR (sjunga)": [
                    { person: "yo", spanish: "canto" },
                    { person: "t√∫", spanish: "cantas" },
                    { person: "√©l/ella/usted", spanish: "canta" },
                    { person: "nosotros/nosotras", spanish: "cantamos" },
                    { person: "vosotros/vosotras", spanish: "cant√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "cantan" }
                ],
                "BAILAR (dansa)": [
                    { person: "yo", spanish: "bailo" },
                    { person: "t√∫", spanish: "bailas" },
                    { person: "√©l/ella/usted", spanish: "baila" },
                    { person: "nosotros/nosotras", spanish: "bailamos" },
                    { person: "vosotros/vosotras", spanish: "bail√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "bailan" }
                ],
                "COMPRAR (k√∂pa)": [
                    { person: "yo", spanish: "compro" },
                    { person: "t√∫", spanish: "compras" },
                    { person: "√©l/ella/usted", spanish: "compra" },
                    { person: "nosotros/nosotras", spanish: "compramos" },
                    { person: "vosotros/vosotras", spanish: "compr√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "compran" }
                ],
                "MIRAR (titta)": [
                    { person: "yo", spanish: "miro" },
                    { person: "t√∫", spanish: "miras" },
                    { person: "√©l/ella/usted", spanish: "mira" },
                    { person: "nosotros/nosotras", spanish: "miramos" },
                    { person: "vosotros/vosotras", spanish: "mir√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "miran" }
                ],
                "USAR (anv√§nda)": [
                    { person: "yo", spanish: "uso" },
                    { person: "t√∫", spanish: "usas" },
                    { person: "√©l/ella/usted", spanish: "usa" },
                    { person: "nosotros/nosotras", spanish: "usamos" },
                    { person: "vosotros/vosotras", spanish: "us√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "usan" }
                ],
                "PREPARAR (f√∂rbereda)": [
                    { person: "yo", spanish: "preparo" },
                    { person: "t√∫", spanish: "preparas" },
                    { person: "√©l/ella/usted", spanish: "prepara" },
                    { person: "nosotros/nosotras", spanish: "preparamos" },
                    { person: "vosotros/vosotras", spanish: "prepar√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "preparan" }
                ],
                "ENCONTRAR (hitta)": [
                    { person: "yo", spanish: "encuentro" },
                    { person: "t√∫", spanish: "encuentras" },
                    { person: "√©l/ella/usted", spanish: "encuentra" },
                    { person: "nosotros/nosotras", spanish: "encontramos" },
                    { person: "vosotros/vosotras", spanish: "encontr√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "encuentran" }
                ]
            },
            "II. -ER-verb": {
                "COMER (√§ta)": [
                    { person: "yo", spanish: "como", swedish: "jag" },
                    { person: "t√∫", spanish: "comes", swedish: "du" },
                    { person: "√©l/ella/usted", spanish: "come", swedish: "han/hon/ni" },
                    { person: "nosotros/nosotras", spanish: "comemos", swedish: "vi" },
                    { person: "vosotros/vosotras", spanish: "com√©is", swedish: "ni" },
                    { person: "ellos/ellas/ustedes", spanish: "comen", swedish: "de/ni" }
                ],
                "BEBER (dricka)": [
                    { person: "yo", spanish: "bebo" },
                    { person: "t√∫", spanish: "bebes" },
                    { person: "√©l/ella/usted", spanish: "bebe" },
                    { person: "nosotros/nosotras", spanish: "bebemos" },
                    { person: "vosotros/vosotras", spanish: "beb√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "beben" }
                ],
                "APRENDER (l√§ra sig)": [
                    { person: "yo", spanish: "aprendo" },
                    { person: "t√∫", spanish: "aprendes" },
                    { person: "√©l/ella/usted", spanish: "aprende" },
                    { person: "nosotros/nosotras", spanish: "aprendemos" },
                    { person: "vosotros/vosotras", spanish: "aprend√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "aprenden" }
                ],
                "VENDER (s√§lja)": [
                    { person: "yo", spanish: "vendo" },
                    { person: "t√∫", spanish: "vendes" },
                    { person: "√©l/ella/usted", spanish: "vende" },
                    { person: "nosotros/nosotras", spanish: "vendemos" },
                    { person: "vosotros/vosotras", spanish: "vend√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "venden" }
                ],
                "RESPONDER (svara)": [
                    { person: "yo", spanish: "respondo" },
                    { person: "t√∫", spanish: "respondes" },
                    { person: "√©l/ella/usted", spanish: "responde" },
                    { person: "nosotros/nosotras", spanish: "respondemos" },
                    { person: "vosotros/vosotras", spanish: "respond√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "responden" }
                ],
                "CORRER (springa)": [
                    { person: "yo", spanish: "corro" },
                    { person: "t√∫", spanish: "corres" },
                    { person: "√©l/ella/usted", spanish: "corre" },
                    { person: "nosotros/nosotras", spanish: "corremos" },
                    { person: "vosotros/vosotras", spanish: "corr√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "corren" }
                ],
                "CREER (tro)": [
                    { person: "yo", spanish: "creo" },
                    { person: "t√∫", spanish: "crees" },
                    { person: "√©l/ella/usted", spanish: "cree" },
                    { person: "nosotros/nosotras", spanish: "creemos" },
                    { person: "vosotros/vosotras", spanish: "cre√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "creen" }
                ],
                "CONOCER (k√§nna till)": [
                    { person: "yo", spanish: "conozco" },
                    { person: "t√∫", spanish: "conoces" },
                    { person: "√©l/ella/usted", spanish: "conoce" },
                    { person: "nosotros/nosotras", spanish: "conocemos" },
                    { person: "vosotros/vosotras", spanish: "conoc√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "conocen" }
                ],
                "ROMPER (bryta)": [
                    { person: "yo", spanish: "rompo" },
                    { person: "t√∫", spanish: "rompes" },
                    { person: "√©l/ella/usted", spanish: "rompe" },
                    { person: "nosotros/nosotras", spanish: "rompemos" },
                    { person: "vosotros/vosotras", spanish: "romp√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "rompen" }
                ]
            },
            "III. -IR-verb": {
                "VIVIR (bo)": [
                    { person: "yo", spanish: "vivo", swedish: "jag" },
                    { person: "t√∫", spanish: "vives", swedish: "du" },
                    { person: "√©l/ella/usted", spanish: "vive", swedish: "han/hon/ni" },
                    { person: "nosotros/nosotras", spanish: "vivimos", swedish: "vi" },
                    { person: "vosotros/vosotras", spanish: "viv√≠s", swedish: "ni" },
                    { person: "ellos/ellas/ustedes", spanish: "viven", swedish: "de/ni" }
                ],
                "ESCRIBIR (skriva)": [
                    { person: "yo", spanish: "escribo" },
                    { person: "t√∫", spanish: "escribes" },
                    { person: "√©l/ella/usted", spanish: "escribe" },
                    { person: "nosotros/nosotras", spanish: "escribimos" },
                    { person: "vosotros/vosotras", spanish: "escrib√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "escriben" }
                ],
                "DECIDIR (best√§mma)": [
                    { person: "yo", spanish: "decido" },
                    { person: "t√∫", spanish: "decides" },
                    { person: "√©l/ella/usted", spanish: "decide" },
                    { person: "nosotros/nosotras", spanish: "decidimos" },
                    { person: "vosotros/vosotras", spanish: "decid√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "deciden" }
                ],
                "RECIBIR (ta emot)": [
                    { person: "yo", spanish: "recibo" },
                    { person: "t√∫", spanish: "recibes" },
                    { person: "√©l/ella/usted", spanish: "recibe" },
                    { person: "nosotros/nosotras", spanish: "recibimos" },
                    { person: "vosotros/vosotras", spanish: "recib√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "reciben" }
                ],
                "ASISTIR (delta)": [
                    { person: "yo", spanish: "asisto" },
                    { person: "t√∫", spanish: "asistes" },
                    { person: "√©l/ella/usted", spanish: "asiste" },
                    { person: "nosotros/nosotras", spanish: "asistimos" },
                    { person: "vosotros/vosotras", spanish: "asist√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "asisten" }
                ],
                "PERMITIR (till√•ta)": [
                    { person: "yo", spanish: "permito" },
                    { person: "t√∫", spanish: "permites" },
                    { person: "√©l/ella/usted", spanish: "permite" },
                    { person: "nosotros/nosotras", spanish: "permitimos" },
                    { person: "vosotros/vosotras", spanish: "permit√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "permiten" }
                ],
                "SUBIR (g√• upp)": [
                    { person: "yo", spanish: "subo" },
                    { person: "t√∫", spanish: "subes" },
                    { person: "√©l/ella/usted", spanish: "sube" },
                    { person: "nosotros/nosotras", spanish: "subimos" },
                    { person: "vosotros/vosotras", spanish: "sub√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "suben" }
                ],
                "COMPARTIR (dela)": [
                    { person: "yo", spanish: "comparto" },
                    { person: "t√∫", spanish: "compartes" },
                    { person: "√©l/ella/usted", spanish: "comparte" },
                    { person: "nosotros/nosotras", spanish: "compartimos" },
                    { person: "vosotros/vosotras", spanish: "compart√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "comparten" }
                ],
                "ADMITIR (erk√§nna)": [
                    { person: "yo", spanish: "admito" },
                    { person: "t√∫", spanish: "admites" },
                    { person: "√©l/ella/usted", spanish: "admite" },
                    { person: "nosotros/nosotras", spanish: "admitimos" },
                    { person: "vosotros/vosotras", spanish: "admit√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "admiten" }
                ],
                "EXISTIR (existera)": [
                    { person: "yo", spanish: "existo" },
                    { person: "t√∫", spanish: "existes" },
                    { person: "√©l/ella/usted", spanish: "existe" },
                    { person: "nosotros/nosotras", spanish: "existimos" },
                    { person: "vosotros/vosotras", spanish: "exist√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "existen" }
                ],
                "ABRIR (√∂ppna)": [
                    { person: "yo", spanish: "abro" },
                    { person: "t√∫", spanish: "abres" },
                    { person: "√©l/ella/usted", spanish: "abre" },
                    { person: "nosotros/nosotras", spanish: "abrimos" },
                    { person: "vosotros/vosotras", spanish: "abr√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "abren" }
                ]
            },
            "IV. Oregelbundna verb": {
                "SER (vara)": [
                    { person: "yo", spanish: "soy", swedish: "jag" },
                    { person: "t√∫", spanish: "eres", swedish: "du" },
                    { person: "√©l/ella/usted", spanish: "es", swedish: "han/hon/ni" },
                    { person: "nosotros/nosotras", spanish: "somos", swedish: "vi" },
                    { person: "vosotros/vosotras", spanish: "sois", swedish: "ni" },
                    { person: "ellos/ellas/ustedes", spanish: "son", swedish: "de/ni" }
                ],
                "ESTAR (vara, befinna sig)": [
                    { person: "yo", spanish: "estoy" },
                    { person: "t√∫", spanish: "est√°s" },
                    { person: "√©l/ella/usted", spanish: "est√°" },
                    { person: "nosotros/nosotras", spanish: "estamos" },
                    { person: "vosotros/vosotras", spanish: "est√°is" },
                    { person: "ellos/ellas/ustedes", spanish: "est√°n" }
                ],
                "TENER (ha)": [
                    { person: "yo", spanish: "tengo" },
                    { person: "t√∫", spanish: "tienes" },
                    { person: "√©l/ella/usted", spanish: "tiene" },
                    { person: "nosotros/nosotras", spanish: "tenemos" },
                    { person: "vosotros/vosotras", spanish: "ten√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "tienen" }
                ],
                "HACER (g√∂ra)": [
                    { person: "yo", spanish: "hago" },
                    { person: "t√∫", spanish: "haces" },
                    { person: "√©l/ella/usted", spanish: "hace" },
                    { person: "nosotros/nosotras", spanish: "hacemos" },
                    { person: "vosotros/vosotras", spanish: "hac√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "hacen" }
                ],
                "PODER (kunna)": [
                    { person: "yo", spanish: "puedo" },
                    { person: "t√∫", spanish: "puedes" },
                    { person: "√©l/ella/usted", spanish: "puede" },
                    { person: "nosotros/nosotras", spanish: "podemos" },
                    { person: "vosotros/vosotras", spanish: "pod√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "pueden" }
                ],
                "IR (g√•, √•ka)": [
                    { person: "yo", spanish: "voy" },
                    { person: "t√∫", spanish: "vas" },
                    { person: "√©l/ella/usted", spanish: "va" },
                    { person: "nosotros/nosotras", spanish: "vamos" },
                    { person: "vosotros/vosotras", spanish: "vais" },
                    { person: "ellos/ellas/ustedes", spanish: "van" }
                ],
                "DECIR (s√§ga)": [
                    { person: "yo", spanish: "digo" },
                    { person: "t√∫", spanish: "dices" },
                    { person: "√©l/ella/usted", spanish: "dice" },
                    { person: "nosotros/nosotras", spanish: "decimos" },
                    { person: "vosotros/vosotras", spanish: "dec√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "dicen" }
                ],
                "VER (se)": [
                    { person: "yo", spanish: "veo" },
                    { person: "t√∫", spanish: "ves" },
                    { person: "√©l/ella/usted", spanish: "ve" },
                    { person: "nosotros/nosotras", spanish: "vemos" },
                    { person: "vosotros/vosotras", spanish: "veis" },
                    { person: "ellos/ellas/ustedes", spanish: "ven" }
                ],
                "DAR (ge)": [
                    { person: "yo", spanish: "doy" },
                    { person: "t√∫", spanish: "das" },
                    { person: "√©l/ella/usted", spanish: "da" },
                    { person: "nosotros/nosotras", spanish: "damos" },
                    { person: "vosotros/vosotras", spanish: "dais" },
                    { person: "ellos/ellas/ustedes", spanish: "dan" }
                ],
                "SABER (veta)": [
                    { person: "yo", spanish: "s√©" },
                    { person: "t√∫", spanish: "sabes" },
                    { person: "√©l/ella/usted", spanish: "sabe" },
                    { person: "nosotros/nosotras", spanish: "sabemos" },
                    { person: "vosotros/vosotras", spanish: "sab√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "saben" }
                ],
                "QUERER (vilja, √§lska)": [
                    { person: "yo", spanish: "quiero" },
                    { person: "t√∫", spanish: "quieres" },
                    { person: "√©l/ella/usted", spanish: "quiere" },
                    { person: "nosotros/nosotras", spanish: "queremos" },
                    { person: "vosotros/vosotras", spanish: "quer√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "quieren" }
                ],
                "VENIR (komma)": [
                    { person: "yo", spanish: "vengo" },
                    { person: "t√∫", spanish: "vienes" },
                    { person: "√©l/ella/usted", spanish: "viene" },
                    { person: "nosotros/nosotras", spanish: "venimos" },
                    { person: "vosotros/vosotras", spanish: "ven√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "vienen" }
                ],
                "PONER (s√§tta, st√§lla, l√§gga)": [
                    { person: "yo", spanish: "pongo" },
                    { person: "t√∫", spanish: "pones" },
                    { person: "√©l/ella/usted", spanish: "pone" },
                    { person: "nosotros/nosotras", spanish: "ponemos" },
                    { person: "vosotros/vosotras", spanish: "pon√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "ponen" }
                ],
                "SALIR (g√• ut)": [
                    { person: "yo", spanish: "salgo" },
                    { person: "t√∫", spanish: "sales" },
                    { person: "√©l/ella/usted", spanish: "sale" },
                    { person: "nosotros/nosotras", spanish: "salimos" },
                    { person: "vosotros/vosotras", spanish: "sal√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "salen" }
                ],
                "TRAER (ta med sig)": [
                    { person: "yo", spanish: "traigo" },
                    { person: "t√∫", spanish: "traes" },
                    { person: "√©l/ella/usted", spanish: "trae" },
                    { person: "nosotros/nosotras", spanish: "traemos" },
                    { person: "vosotros/vosotras", spanish: "tra√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "traen" }
                ],
                "OBTENER (f√•, erh√•lla)": [
                    { person: "yo", spanish: "obtengo" },
                    { person: "t√∫", spanish: "obtienes" },
                    { person: "√©l/ella/usted", spanish: "obtiene" },
                    { person: "nosotros/nosotras", spanish: "obtenemos" },
                    { person: "vosotros/vosotras", spanish: "obten√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "obtienen" }
                ],
                "MANTENER (h√•lla, beh√•lla)": [
                    { person: "yo", spanish: "mantengo" },
                    { person: "t√∫", spanish: "mantienes" },
                    { person: "√©l/ella/usted", spanish: "mantiene" },
                    { person: "nosotros/nosotras", spanish: "mantenemos" },
                    { person: "vosotros/vosotras", spanish: "manten√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "mantienen" }
                ],
                "HABER (h√•lla, ha)": [
                    { person: "yo", spanish: "he" },
                    { person: "t√∫", spanish: "has" },
                    { person: "√©l/ella/usted", spanish: "ha" },
                    { person: "nosotros/nosotras", spanish: "hemos" },
                    { person: "vosotros/vosotras", spanish: "hab√©is" },
                    { person: "ellos/ellas/ustedes", spanish: "han" }
                ],
                "O√çR (h√∂ra)": [
                    { person: "yo", spanish: "oigo" },
                    { person: "t√∫", spanish: "oyes" },
                    { person: "√©l/ella/usted", spanish: "oye" },
                    { person: "nosotros/nosotras", spanish: "o√≠mos" },
                    { person: "vosotros/vosotras", spanish: "o√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "oyen" }
                ],
                "TRADUCIR (√∂vers√§tta)": [
                    { person: "yo", spanish: "traduzco" },
                    { person: "t√∫", spanish: "traduces" },
                    { person: "√©l/ella/usted", spanish: "traduce" },
                    { person: "nosotros/nosotras", spanish: "traducimos" },
                    { person: "vosotros/vosotras", spanish: "traduc√≠s" },
                    { person: "ellos/ellas/ustedes", spanish: "traducen" }
                ]
            }
        };

        let totalInputs = 0;
        let isMovingFocus = false; // Flag to prevent blur events during focus moves

        function normalize(str) {
            return str.toLowerCase().trim()
                .replace(/√•/g, 'a').replace(/√§/g, 'a').replace(/√∂/g, 'o')
                .replace(/√°/g, 'a').replace(/√©/g, 'e').replace(/√≠/g, 'i')
                .replace(/√≥/g, 'o').replace(/√∫/g, 'u').replace(/√±/g, 'n');
        }

        function speakText(text) {
            // Using Google Translate TTS API
            const audioUrl = `https://translate.google.com/translate_tts?ie=UTF-8&tl=es&client=tw-ob&q=${encodeURIComponent(text)}`;
            const audio = new Audio(audioUrl);
            
            return new Promise((resolve, reject) => {
                audio.onended = () => resolve();
                audio.onerror = () => {
                    console.log('Audio playback failed, trying fallback');
                    // Fallback to browser's speech synthesis if available
                    if ('speechSynthesis' in window) {
                        window.speechSynthesis.cancel();
                        const utterance = new SpeechSynthesisUtterance(text);
                        utterance.lang = 'es-ES';
                        utterance.rate = 0.8;
                        utterance.onend = () => resolve();
                        window.speechSynthesis.speak(utterance);
                    } else {
                        resolve();
                    }
                };
                audio.play().catch(reject);
            });
        }

        function speakAndFill(inputId, correctAnswer, fullPhrase) {
            const input = document.getElementById(inputId);
            const feedback = document.getElementById(inputId + '-feedback');
            const userAnswer = input.value.trim();
            
            // Speak the full phrase
            speakText(fullPhrase);
            
            // Check if answer is empty or incorrect
            const isCorrect = normalize(userAnswer) === normalize(correctAnswer);
            if (!isCorrect || userAnswer === '') {
                // Fill in the correct answer directly
                input.value = correctAnswer;
                input.classList.remove('incorrect');
                input.classList.add('correct');
                feedback.innerHTML = '<span class="correct-icon">‚úì</span>';
                
                updateProgress();
            }
            
            // Move to next input regardless
            const nextInput = getNextInput(inputId);
            if (nextInput) {
                isMovingFocus = true;
                requestAnimationFrame(() => {
                    nextInput.focus();
                    setTimeout(() => { isMovingFocus = false; }, 150);
                });
            }
        }

        function speakAndFillInfinitive(inputId, correctAnswer, verbInfinitive) {
            const input = document.getElementById(inputId);
            const feedback = document.getElementById(inputId + '-feedback');
            const userAnswer = input.value.trim();
            
            // Speak the infinitive
            speakText(verbInfinitive);
            
            // Check if answer is empty or incorrect
            const isCorrect = normalize(userAnswer) === normalize(correctAnswer);
            if (!isCorrect || userAnswer === '') {
                // Fill in the correct answer directly
                input.value = correctAnswer;
                input.classList.remove('incorrect');
                input.classList.add('correct');
                feedback.innerHTML = '<span class="correct-icon">‚úì</span>';
                
                updateProgress();
            }
            
            // Move to next input (first conjugation of this verb)
            const nextInput = getNextInput(inputId);
            if (nextInput) {
                isMovingFocus = true;
                requestAnimationFrame(() => {
                    nextInput.focus();
                    setTimeout(() => { isMovingFocus = false; }, 150);
                });
            }
        }

        async function speakAllConjugations(conjugations, startInputId) {
            // Get all input fields for this verb (starting from the one after the infinitive input)
            const allInputs = Array.from(document.querySelectorAll('input[type="text"]'));
            const startIndex = allInputs.findIndex(input => input.id === startInputId);
            
            // Speak and fill each conjugation
            for (let i = 0; i < conjugations.length; i++) {
                const conjugation = conjugations[i];
                const inputIndex = startIndex + 1 + i; // +1 to skip infinitive input
                
                if (inputIndex < allInputs.length) {
                    const input = allInputs[inputIndex];
                    const feedback = document.getElementById(input.id + '-feedback');
                    
                    // Only fill if empty or incorrect
                    const userAnswer = input.value.trim();
                    const isCorrect = normalize(userAnswer) === normalize(conjugation.spanish);
                    
                    if (!isCorrect || userAnswer === '') {
                        input.value = conjugation.spanish;
                        input.classList.remove('incorrect');
                        input.classList.add('correct');
                        feedback.innerHTML = '<span class="correct-icon">‚úì</span>';
                    }
                }
                
                // Speak the conjugation
                await speakText(conjugation.spanish);
                // Small pause between words (0.5 seconds)
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            // Update progress after all are filled
            updateProgress();
        }

        function getNextInput(currentInputId) {
            const allInputs = Array.from(document.querySelectorAll('input[type="text"]'));
            const currentIndex = allInputs.findIndex(input => input.id === currentInputId);
            if (currentIndex >= 0 && currentIndex < allInputs.length - 1) {
                return allInputs[currentIndex + 1];
            }
            return null;
        }

        function checkAnswer(inputId, correctAnswer, forceCheck = false) {
            // Skip if we're in the middle of moving focus (unless forced)
            if (isMovingFocus && !forceCheck) {
                return;
            }
            
            const input = document.getElementById(inputId);
            const feedback = document.getElementById(inputId + '-feedback');
            const userAnswer = input.value.trim();
            
            if (userAnswer === '') {
                feedback.innerHTML = '';
                input.classList.remove('correct', 'incorrect');
                updateProgress();
                return;
            }
            
            const isCorrect = normalize(userAnswer) === normalize(correctAnswer);
            
            if (isCorrect) {
                input.classList.remove('incorrect');
                input.classList.add('correct');
                feedback.innerHTML = '<span class="correct-icon">‚úì</span>';
                
                // Move to next input if correct
                const nextInput = getNextInput(inputId);
                if (nextInput && forceCheck) {
                    isMovingFocus = true;
                    requestAnimationFrame(() => {
                        nextInput.focus();
                        setTimeout(() => { isMovingFocus = false; }, 100);
                    });
                }
            } else {
                input.classList.remove('correct');
                input.classList.add('incorrect');
                feedback.innerHTML = `
                    <span class="incorrect-text">Fel:</span>
                    <span class="correct-answer">${correctAnswer}</span>
                `;
                
                // Keep focus on current input if incorrect
                if (forceCheck) {
                    isMovingFocus = true;
                    requestAnimationFrame(() => {
                        input.focus();
                        input.select();
                        setTimeout(() => { isMovingFocus = false; }, 100);
                    });
                }
            }
            
            updateProgress();
        }

        function resetAll() {
            const inputs = document.querySelectorAll('input[type="text"]');
            inputs.forEach(input => {
                input.value = '';
                input.classList.remove('correct', 'incorrect');
            });
            
            const feedbacks = document.querySelectorAll('.feedback');
            feedbacks.forEach(feedback => {
                feedback.innerHTML = '';
            });
            
            updateProgress();
        }

        function checkAll() {
            const inputs = document.querySelectorAll('input[type="text"]');
            inputs.forEach(input => {
                const correctAnswer = input.dataset.correct;
                if (input.value.trim() !== '') {
                    checkAnswer(input.id, correctAnswer);
                }
            });
        }

        function fillAll() {
            const inputs = document.querySelectorAll('input[type="text"]');
            
            // Batch update without triggering individual checks
            inputs.forEach(input => {
                const correctAnswer = input.dataset.correct;
                input.value = correctAnswer;
                input.classList.remove('incorrect');
                input.classList.add('correct');
                
                const feedback = document.getElementById(input.id + '-feedback');
                feedback.innerHTML = '<span class="correct-icon">‚úì</span>';
            });
            
            // Update progress once at the end
            updateProgress();
        }

        function updateProgress() {
            const inputs = document.querySelectorAll('input[type="text"]');
            let correctCount = 0;
            let totalFilled = 0;
            
            inputs.forEach(input => {
                if (input.value.trim() !== '') {
                    totalFilled++;
                    if (input.classList.contains('correct')) {
                        correctCount++;
                    }
                }
            });
            
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('total-count').textContent = totalInputs;
            
            const percentage = totalInputs > 0 ? Math.round((correctCount / totalInputs) * 100) : 0;
            const progressFill = document.getElementById('progress-fill');
            progressFill.style.width = percentage + '%';
            progressFill.textContent = percentage + '%';
        }

        function generateHTML() {
            const container = document.getElementById('verbs-container');
            let inputCounter = 0;
            
            for (const [category, verbs] of Object.entries(verbData)) {
                const section = document.createElement('div');
                section.className = 'verb-section';
                
                const categoryHeader = document.createElement('div');
                categoryHeader.className = 'verb-category';
                categoryHeader.textContent = category;
                section.appendChild(categoryHeader);
                
                for (const [verbName, conjugations] of Object.entries(verbs)) {
                    // Extract verb infinitive and Swedish translation
                    // Format can be: "VERB (translation)" or just "VERB"
                    const match = verbName.match(/^([A-Z√Ö√Ñ√ñ√ç√â√Å√ö√ì√ë√º√ú]+)\s*(?:\(([^)]+)\))?$/);
                    const verbInfinitive = match ? match[1] : verbName;
                    const correctTranslation = match && match[2] ? match[2] : '';
                    
                    const verbHeader = document.createElement('div');
                    verbHeader.className = 'verb-header';
                    
                    const infInputId = 'inf-input-' + inputCounter++;
                    totalInputs++;
                    
                    // Store conjugations JSON for the speak all button
                    const conjugationsJson = JSON.stringify(conjugations).replace(/'/g, "\\'").replace(/"/g, "&quot;");
                    
                    verbHeader.innerHTML = `
                        <span style="font-weight: bold; color: #2E75B6; font-size: 1.2em;">
                            ${verbInfinitive}
                            <button class="speaker-btn" onclick="speakAndFillInfinitive('${infInputId}', '${correctTranslation}', '${verbInfinitive.toLowerCase()}')" title="Lyssna och fyll i √∂vers√§ttning">üîä</button>
                            <button class="speaker-btn" onclick='speakAllConjugations(${conjugationsJson}, "${infInputId}")' title="Lyssna och fyll i alla former" style="font-size: 18px;">üîäüîä</button>
                        </span>
                        <span style="color: #888; margin: 0 10px;">‚Üí</span>
                        <div style="display: flex; gap: 8px; align-items: center; flex: 1;">
                            <input 
                                type="text" 
                                id="${infInputId}" 
                                placeholder="√ñvers√§ttning..."
                                data-correct="${correctTranslation}"
                                onblur="checkAnswer('${infInputId}', '${correctTranslation.replace(/'/g, "\\'")}', false)"
                                onkeypress="if(event.key === 'Enter') { event.preventDefault(); checkAnswer('${infInputId}', '${correctTranslation.replace(/'/g, "\\'")}', true); }"
                                style="flex: 1;"
                            >
                            <button class="check-btn" onclick="checkAnswer('${infInputId}', '${correctTranslation.replace(/'/g, "\\'")}', true)">Kolla</button>
                            <div class="feedback" id="${infInputId}-feedback" style="display: inline-flex;"></div>
                        </div>
                    `;
                    section.appendChild(verbHeader);
                    
                    const table = document.createElement('table');
                    table.className = 'verb-table';
                    
                    const hasSwedish = conjugations[0].swedish !== undefined;
                    
                    const thead = document.createElement('thead');
                    const headerRow = document.createElement('tr');
                    headerRow.innerHTML = `
                        <th>Person</th>
                        ${hasSwedish ? '<th>Svenska</th>' : ''}
                        <th>Ditt svar</th>
                        <th>Resultat</th>
                    `;
                    thead.appendChild(headerRow);
                    table.appendChild(thead);
                    
                    const tbody = document.createElement('tbody');
                    conjugations.forEach(conj => {
                        const row = document.createElement('tr');
                        const inputId = 'input-' + inputCounter++;
                        totalInputs++;
                        
                        row.innerHTML = `
                            <td style="width: 20%;">
                                ${conj.person}
                                <button class="speaker-btn" onclick="speakAndFill('${inputId}', '${conj.spanish.replace(/'/g, "\\'")}', '${conj.spanish}')" title="Lyssna och fyll i: ${conj.spanish}">üîä</button>
                            </td>
                            ${hasSwedish ? `<td style="width: 15%;">${conj.swedish}</td>` : ''}
                            <td style="width: ${hasSwedish ? '40%' : '55%'};">
                                <div class="input-container">
                                    <input 
                                        type="text" 
                                        id="${inputId}" 
                                        placeholder="Skriv h√§r..."
                                        data-correct="${conj.spanish}"
                                        onblur="checkAnswer('${inputId}', '${conj.spanish.replace(/'/g, "\\'")}', false)"
                                        onkeypress="if(event.key === 'Enter') { event.preventDefault(); checkAnswer('${inputId}', '${conj.spanish.replace(/'/g, "\\'")}', true); }">
                                    <button class="check-btn" onclick="checkAnswer('${inputId}', '${conj.spanish.replace(/'/g, "\\'")}', true)">Kolla</button>
                                </div>
                            </td>
                            <td style="width: 25%;">
                                <div class="feedback" id="${inputId}-feedback"></div>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                    table.appendChild(tbody);
                    section.appendChild(table);
                }
                
                container.appendChild(section);
            }
            
            updateProgress();
        }

        generateHTML();
    </script>
</body>
</html>
